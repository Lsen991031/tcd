ucf101: 101 classes
Method : OURS
----AGE 1----
current_task  [95, 14, 71, 96, 99, 98, 2, 64, 66, 42]
current_head  61
Phase 2 : Train RGB Model in an Incremental Manner
=> base model: resnet34
----------------------resnet34 pretraining----------------------
------------------------------success---------------------------
Load the Previous Model
Copy the old Model
lambda_0  : [1.0, 0.022583179581272428]
Increment the Model
SplitCosineLinear(
  input_features=512, output_features=183, sigma=tensor([3.8345]), eta=tensor([3.0845])
  (fc1): CosineLinear(input_features=512, output_features=153, sigma=1.0, eta=1.0)
  (fc2): CosineLinear(input_features=512, output_features=30, sigma=1.0, eta=1.0)
)
video number : 893
video number + exemplar : 1148
DataLoader Constructed : Train 35
Optimizer Constructed
video number : 893
video number + exemplar : 893
Initialize Cosine Classifier
Computing the class mean vectors...
/home/ustc/anaconda3/envs/lhc/lib/python3.7/site-packages/torch/nn/parallel/_functions.py:61: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
Traceback (most recent call last):
  File "main.py", line 101, in <module>
    main()
  File "main.py", line 71, in main
    train_i_cl.train_task(args, i, current_task, current_head, class_indexer, model_flow=model_flow, prefix=prefix)
  File "/home/ustc/ls/tcd_code/train/train_i_cl.py", line 478, in train_task
    _train(args, train_loader, model, criterion, optimizer, epoch, age, regularizer=regularizer, lambda_0=lambda_0, model_old=model_old, importance_list=importance_list)
  File "/home/ustc/ls/tcd_code/train/train_i_cl.py", line 150, in _train
    loss_kd_logit = cl_dist.lf_dist_tcd(feat,feat_old,factor=importanceList if importanceList else None)
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()
importanceList [Parameter containing:
tensor([[0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840,
         0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840,
         0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840,
         0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840,
         0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840,
         0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840,
         0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840,
         0.9840],
        [0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840,
         0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840,
         0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840,
         0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840,
         0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840,
         0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840,
         0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840,
         0.9840],
        [0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840,
         0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840,
         0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840,
         0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840,
         0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840,
         0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840,
         0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840,
         0.9840],
        [0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840,
         0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840,
         0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840,
         0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840,
         0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840,
         0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840,
         0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840,
         0.9840],
        [0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840,
         0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840,
         0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840,
         0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840,
         0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840,
         0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840,
         0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840,
         0.9840],
        [0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840,
         0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840,
         0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840,
         0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840,
         0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840,
         0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840,
         0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840,
         0.9840],
        [0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840,
         0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840,
         0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840,
         0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840,
         0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840,
         0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840,
         0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840,
         0.9840],
        [0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840,
         0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840,
         0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840,
         0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840,
         0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840,
         0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840,
         0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840, 0.9840,
         0.9840]], device='cuda:0', requires_grad=True)
 Parameter containing:
tensor([[0.9840, 0.9840, 0.9840,  ..., 0.9840, 0.9840, 0.9840],
        [0.9840, 0.9840, 0.9840,  ..., 0.9840, 0.9840, 0.9840],
        [0.9840, 0.9840, 0.9840,  ..., 0.9840, 0.9840, 0.9840],
        ...,
        [0.9840, 0.9840, 0.9840,  ..., 0.9840, 0.9840, 0.9840],
        [0.9840, 0.9840, 0.9840,  ..., 0.9840, 0.9840, 0.9840],
        [0.9840, 0.9840, 0.9840,  ..., 0.9840, 0.9840, 0.9840]],
       device='cuda:0', requires_grad=True)
 Parameter containing:
tensor([[0.9840, 0.9840, 0.9840,  ..., 0.9840, 0.9840, 0.9840],
        [0.9840, 0.9840, 0.9840,  ..., 0.9840, 0.9840, 0.9840],
        [0.9840, 0.9840, 0.9840,  ..., 0.9840, 0.9840, 0.9840],
        ...,
        [0.9840, 0.9840, 0.9840,  ..., 0.9840, 0.9840, 0.9840],
        [0.9840, 0.9840, 0.9840,  ..., 0.9840, 0.9840, 0.9840],
        [0.9840, 0.9840, 0.9840,  ..., 0.9840, 0.9840, 0.9840]],
       device='cuda:0', requires_grad=True)
 Parameter containing:
tensor([[0.9840, 0.9840, 0.9840,  ..., 0.9840, 0.9840, 0.9840],
        [0.9840, 0.9840, 0.9840,  ..., 0.9840, 0.9840, 0.9840],
        [0.9840, 0.9840, 0.9840,  ..., 0.9840, 0.9840, 0.9840],
        ...,
        [0.9840, 0.9840, 0.9840,  ..., 0.9840, 0.9840, 0.9840],
        [0.9840, 0.9840, 0.9840,  ..., 0.9840, 0.9840, 0.9840],
        [0.9840, 0.9840, 0.9840,  ..., 0.9840, 0.9840, 0.9840]],
       device='cuda:0', requires_grad=True)
 Parameter containing:
tensor([[0.9840, 0.9840, 0.9840,  ..., 0.9840, 0.9840, 0.9840],
        [0.9840, 0.9840, 0.9840,  ..., 0.9840, 0.9840, 0.9840],
        [0.9840, 0.9840, 0.9840,  ..., 0.9840, 0.9840, 0.9840],
        ...,
        [0.9840, 0.9840, 0.9840,  ..., 0.9840, 0.9840, 0.9840],
        [0.9840, 0.9840, 0.9840,  ..., 0.9840, 0.9840, 0.9840],
        [0.9840, 0.9840, 0.9840,  ..., 0.9840, 0.9840, 0.9840]],
       device='cuda:0', requires_grad=True)]